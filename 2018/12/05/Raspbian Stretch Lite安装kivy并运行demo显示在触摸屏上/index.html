<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Raspbian Stretch Lite安装kivy并运行demo显示在触摸屏上 | Yes I need Root</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="记录下在Raspbian Stretch Lite安装kivy的过程以备查 准备工作 从树莓派官网下载Raspbian Stretch Lite镜像 windows通过Win32DiskImager（macos可通过Etcher或者命令行）将.img刷入microsd卡（此处使用的是3b）。Stretch Lite的话，4g的卡即可，但现在一般不会买4g了。。。 在/boot/目录新建不含后缀的文">
<meta name="keywords" content="树莓派,Kivy">
<meta property="og:type" content="article">
<meta property="og:title" content="Raspbian Stretch Lite安装kivy并运行demo显示在触摸屏上">
<meta property="og:url" content="http://yoursite.com/2018/12/05/Raspbian Stretch Lite安装kivy并运行demo显示在触摸屏上/index.html">
<meta property="og:site_name" content="Yes I need Root">
<meta property="og:description" content="记录下在Raspbian Stretch Lite安装kivy的过程以备查 准备工作 从树莓派官网下载Raspbian Stretch Lite镜像 windows通过Win32DiskImager（macos可通过Etcher或者命令行）将.img刷入microsd卡（此处使用的是3b）。Stretch Lite的话，4g的卡即可，但现在一般不会买4g了。。。 在/boot/目录新建不含后缀的文">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-12-10T15:01:06.445Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Raspbian Stretch Lite安装kivy并运行demo显示在触摸屏上">
<meta name="twitter:description" content="记录下在Raspbian Stretch Lite安装kivy的过程以备查 准备工作 从树莓派官网下载Raspbian Stretch Lite镜像 windows通过Win32DiskImager（macos可通过Etcher或者命令行）将.img刷入microsd卡（此处使用的是3b）。Stretch Lite的话，4g的卡即可，但现在一般不会买4g了。。。 在/boot/目录新建不含后缀的文">
  
    <link rel="alternate" href="/atom.xml" title="Yes I need Root" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Yes I need Root</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Raspbian Stretch Lite安装kivy并运行demo显示在触摸屏上" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/05/Raspbian Stretch Lite安装kivy并运行demo显示在触摸屏上/" class="article-date">
  <time datetime="2018-12-05T12:39:12.000Z" itemprop="datePublished">2018-12-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Raspbian Stretch Lite安装kivy并运行demo显示在触摸屏上
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>记录下在Raspbian Stretch Lite安装kivy的过程以备查</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ol>
<li>从树莓派官网下载<a href="https://www.raspberrypi.org/downloads/raspbian/" target="_blank" rel="noopener">Raspbian Stretch Lite镜像</a></li>
<li>windows通过Win32DiskImager（macos可通过Etcher或者命令行）将.img刷入microsd卡（此处使用的是3b）。Stretch Lite的话，4g的卡即可，但现在一般不会买4g了。。。</li>
<li>在/boot/目录新建不含后缀的文件ssh，开启ssh功能</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch ssh</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>上电，ssh连接。</li>
</ol>
<h2 id="在树莓派上安装kivy"><a href="#在树莓派上安装kivy" class="headerlink" title="在树莓派上安装kivy"></a>在树莓派上安装kivy</h2><p>官方安装指南<a href="https://kivy.org/doc/stable/installation/installation-rpi.html#manual-installation-on-raspbian-jessie-stretch" target="_blank" rel="noopener">Installation on Raspberry Pi</a></p>
<p>此处想要安装的是python3版本，将官方教程的pip和python改为pip3和python3</p>
<p>1.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure></p>
<p>2.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 这里如果说没有获取某些包让apt-get update或者--fix-missing那就再后面加上--fix-missing</span><br><span class="line"></span><br><span class="line">sudo apt-get install libsdl2-dev libsdl2-image-dev libsdl2-mixer-dev libsdl2-ttf-dev \</span><br><span class="line">   pkg-config libgl1-mesa-dev libgles2-mesa-dev \</span><br><span class="line">   python3-setuptools libgstreamer1.0-dev git-core \</span><br><span class="line">   gstreamer1.0-plugins-&#123;bad,base,good,ugly&#125; \</span><br><span class="line">   gstreamer1.0-&#123;omx,alsa&#125; python3-dev libmtdev-dev \</span><br><span class="line">   xclip xsel python3-pip</span><br></pre></td></tr></table></figure></p>
<p>3.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip3 install -U Cython==0.28.2</span><br></pre></td></tr></table></figure></p>
<p>4.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip3 install git+https://github.com/kivy/kivy.git@master</span><br></pre></td></tr></table></figure></p>
<p>太慢了，就直接浏览器下载了<a href="https://codeload.github.com/kivy/kivy/zip/stable-1.10" target="_blank" rel="noopener">1.10.x的stable版本</a>，再通过WinSCP传到树莓派。</p>
<p>5.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd kivy-stable-1.10</span><br></pre></td></tr></table></figure></p>
<p>6.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make</span><br></pre></td></tr></table></figure></p>
<p>make这里会报错，后面再一起记录下</p>
<p>7.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;export PYTHONPATH=$(pwd):\$PYTHONPATH&quot; &gt;&gt; ~/.profile</span><br></pre></td></tr></table></figure></p>
<p>8.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.profile</span><br></pre></td></tr></table></figure></p>
<ol start="9">
<li>运行demo</li>
</ol>
<h3 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h3><ol>
<li>make报错Cython is missing, it’s required for compiling kivy !<br>这里通过改变Makefile的PYTHON值解决</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano Makefile</span><br></pre></td></tr></table></figure>
<p>把第一行PYTHON=python改为PYTHON=python3，因为之前依赖所安装的都是python3的，Cython也是。<br>经过很长时间的等待，编译就通过了。<br>这个时候运行demo<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 kivy-stable-1.10/examples/demo/showcase/main.py</span><br></pre></td></tr></table></figure></p>
<p>会继续报错</p>
<ol start="2">
<li>运行main.py报错ImportError: No module named ‘pygments’</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip3 install pygments</span><br></pre></td></tr></table></figure>
<p>不得不提下面这个issue里有个comment简直道出了我的心声<br><a href="https://github.com/kivy/kivy/issues/2115" target="_blank" rel="noopener">Unable to run kivy on raspberry pi with</a></p>
<blockquote>
<p>aleksandaratanasov commented on 4 May 2016<br>Shouldn’t this dependency be actually listed as such? I find it rather annoying that following the official guide on installing Kivy on the RPi you have to dig into the issues on GitHub to find a solution for this problem. After all the demos should be the ones that run without any issues WITH the things that are listed as requirements to get Kivy installed on the system. Please consider adding at least a warning if the required packages for the showcase are not met.</p>
</blockquote>
<ol start="3">
<li>这个时候运行python3 kivy-stable-1.10/examples/demo/showcase/main.py这个demo不会报错了，但是如果不连接显示屏就看不到效果。</li>
<li>树莓派连接显示屏显示no signal</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /boot/config.txt</span><br></pre></td></tr></table></figure>
<p>把<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#hdmi_force_hotplug=1</span><br></pre></td></tr></table></figure></p>
<p>的注释去掉，变为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdmi_force_hotplug=1</span><br></pre></td></tr></table></figure></p>
<p>参考<a href="https://www.raspberrypi.org/forums/viewtopic.php?t=34061" target="_blank" rel="noopener">HDMI monitors says NO SIGNAL (solved)</a></p>
<ol start="5">
<li>重启后运行demo应该有显示了，但是发现触摸好像没反应。<br>参考官方安装指南中<a href="https://kivy.org/doc/stable/installation/installation-rpi.html#using-official-rpi-touch-display" target="_blank" rel="noopener">Using Official RPi touch display</a></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano ~/.kivy/config.ini</span><br></pre></td></tr></table></figure>
<p>更改[input]模块为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mouse = mouse</span><br><span class="line">mtdev_%(name)s = probesysfs,provider=mtdev</span><br><span class="line">hid_%(name)s = probesysfs,provider=hidinput</span><br></pre></td></tr></table></figure></p>
<p>到这里就正常显示及操作了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/12/05/Raspbian Stretch Lite安装kivy并运行demo显示在触摸屏上/" data-id="cjpiyn7ax0001aw0o6gclo8x0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Kivy/">Kivy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/树莓派/">树莓派</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/12/08/Raspbian Stretch Lite设置wifi及静态IP/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Raspbian Stretch Lite设置wifi及静态IP
        
      </div>
    </a>
  
  
    <a href="/2018/10/16/buildozer打包kivy应用程序为安卓apk时卡在refreshing resources/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">buildozer打包kivy应用程序为安卓apk时卡在refreshing resources</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CheckBox/">CheckBox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kivy/">Kivy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LEDE/">LEDE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-RED/">Node-RED</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PyInstaller/">PyInstaller</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PyQt5/">PyQt5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SyntaxError/">SyntaxError</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ToggleButton/">ToggleButton</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/frp/">frp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/macos/">macos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openGL/">openGL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/qt5/">qt5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/serial/">serial</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vs/">vs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开机自启/">开机自启</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/打包/">打包</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树莓派/">树莓派</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CheckBox/" style="font-size: 10px;">CheckBox</a> <a href="/tags/Kivy/" style="font-size: 20px;">Kivy</a> <a href="/tags/LEDE/" style="font-size: 10px;">LEDE</a> <a href="/tags/Node-RED/" style="font-size: 10px;">Node-RED</a> <a href="/tags/PyInstaller/" style="font-size: 10px;">PyInstaller</a> <a href="/tags/PyQt5/" style="font-size: 10px;">PyQt5</a> <a href="/tags/SyntaxError/" style="font-size: 10px;">SyntaxError</a> <a href="/tags/ToggleButton/" style="font-size: 10px;">ToggleButton</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/frp/" style="font-size: 10px;">frp</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/macos/" style="font-size: 10px;">macos</a> <a href="/tags/openGL/" style="font-size: 10px;">openGL</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/qt5/" style="font-size: 10px;">qt5</a> <a href="/tags/serial/" style="font-size: 10px;">serial</a> <a href="/tags/ubuntu/" style="font-size: 15px;">ubuntu</a> <a href="/tags/vs/" style="font-size: 10px;">vs</a> <a href="/tags/开机自启/" style="font-size: 10px;">开机自启</a> <a href="/tags/打包/" style="font-size: 15px;">打包</a> <a href="/tags/树莓派/" style="font-size: 20px;">树莓派</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/12/08/Raspbian Stretch Lite设置wifi及静态IP/">Raspbian Stretch Lite设置wifi及静态IP</a>
          </li>
        
          <li>
            <a href="/2018/12/05/Raspbian Stretch Lite安装kivy并运行demo显示在触摸屏上/">Raspbian Stretch Lite安装kivy并运行demo显示在触摸屏上</a>
          </li>
        
          <li>
            <a href="/2018/10/16/buildozer打包kivy应用程序为安卓apk时卡在refreshing resources/">buildozer打包kivy应用程序为安卓apk时卡在refreshing resources</a>
          </li>
        
          <li>
            <a href="/2018/10/12/运行Node-RED官方docker后安装serial节点/">运行Node-RED官方docker后安装serial节点</a>
          </li>
        
          <li>
            <a href="/2018/10/08/树莓派刷LEDE(OpenWRT)后开机自启frpc/">树莓派刷LEDE(OpenWrt)后开机自启frpc</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 mokusolo<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>